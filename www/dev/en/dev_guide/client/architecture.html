

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Architecture client &mdash; CryptPad 3.23.0 documentation</title>
  

  
  <link rel="icon" type="image/png" href="../../_static/images/main-favicon.png" id="favicon"/>
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/open-sans.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cptools.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/fontawesome.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cp-overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ChainPad et Listmap" href="chainpad.html" />
    <link rel="prev" title="Client" href="../client.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          
            <a href="../../index.html" class="icon icon-home">
              <img src="../../_static/images/sidebar-logo.png" class="logo" alt="Logo"/>
              <div class="icon-title">CryptPad</div>
              <span class="release">3.23.0</span>
            </a>
            
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
          
        </div>

        <div class="wy-side-nav-language-selector">
        	<p class="caption-text">
	        	<select id="language-selector-container">
	        		<option value="en">English</option>
              <option value="fr">Fran√ßais</option>
              <option value="de">Deutsch</option>
	        	</select>
        	</p>
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/instances.html">CryptPad instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/user_account.html">User Account</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/user_account.html#account-types">Account types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/user_account.html#non-registered-user">Non-registered user</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/user_account.html#logged-in-user">Logged in user</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/user_account.html#premium-user">Premium user</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/user_account.html#account-management">Account management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/user_account.html#registration">Registration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/user_account.html#logging-in">Logging in</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/user_account.html#settings">Settings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/user_account.html#account">Account</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/user_account.html#confidentiality">Confidentiality</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/user_account.html#cryptdrive">CryptDrive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/user_account.html#cursor">Cursor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/user_account.html#rich-text">Rich Text</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/user_account.html#code">Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/user_account.html#subscription">Subscription</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/user_account.html#support">Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/user_account.html#notifications">Notifications</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/security.html">Security</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/security.html#passwords-for-documents-and-folders">Passwords for documents and folders</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/security.html#remote-disconnect">Remote Disconnect</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/drive.html">Drive</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/drive.html#display">Display</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/drive.html#managing-documents">Managing documents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/drive.html#folders">Folders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/drive.html#renaming">Renaming</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/drive.html#deleting">Deleting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/drive.html#cryptdrive-history">CryptDrive history</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/drive.html#tags">Tags</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/drive.html#templates">Templates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/collaboration.html">Collaboration / Social</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/collaboration.html#profile">Profile</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/collaboration.html#personal-profile">Personal profile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/collaboration.html#user-profile">User profile</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/collaboration.html#contacts">Contacts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/collaboration.html#add-a-contact">Add a contact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/collaboration.html#manage-contacts">Manage contacts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/collaboration.html#chat-with-contacts">Chat with contacts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/collaboration.html#teams">Teams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/collaboration.html#team-drive">Team Drive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/collaboration.html#team-members">Team members</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/collaboration.html#invite-members">Invite members</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/collaboration.html#roles-and-permissions">Roles and permissions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/collaboration.html#administration">Administration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/collaboration.html#chat">Chat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/collaboration.html#administration-tab">Administration tab</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/share_and_access.html">Share / Access</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/share_and_access.html#share">Share</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/share_and_access.html#access-rights">Access rights</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/share_and_access.html#sharing-with-contacts">Sharing with contacts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/share_and_access.html#sharing-a-link">Sharing a link</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/share_and_access.html#embedding">Embedding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/share_and_access.html#shared-folders">Shared folders</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/share_and_access.html#access">Access</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/share_and_access.html#access-tab">Access tab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/share_and_access.html#access-list">Access List</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/share_and_access.html#owners">Owners</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/applications.html">Applications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/apps/general.html">General</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/general.html#new-document">New document</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/general.html#saving">Saving</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/general.html#make-a-copy">Make a copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/general.html#document-history">Document history</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/general.html#snapshots">Snapshots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/general.html#properties">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/general.html#users-and-chat">Users and chat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/apps/richtext.html">Rich Text</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/richtext.html#toolbar">Toolbar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/richtext.html#import-export">Import/Export</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/richtext.html#comments">Comments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/apps/sheets.html">Spreadsheets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/sheets.html#documentation">Documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/sheets.html#history">History</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/sheets.html#import-export">Import/Export</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/apps/code.html">Code / Markdown</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/code.html#toolbar">Toolbar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/code.html#theme">Theme</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/code.html#import-export">Import/Export</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/code.html#markdown">Markdown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/code.html#images">Images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/code.html#lightbox">Lightbox</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/apps/slides.html">Slides</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/slides.html#toolbar">Toolbar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/slides.html#writing-slides-with-markdown">Writing slides with Markdown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/slides.html#theme">Theme</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/slides.html#import-export">Import/Export</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/slides.html#images">Images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/slides.html#lightbox">Lightbox</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/apps/poll.html">Poll</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/poll.html#toolbar">Toolbar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/poll.html#edit-mode">Edit mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/poll.html#voting">Voting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/poll.html#export">Export</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/apps/kanban.html">Kanban</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/kanban.html#organisation">Organisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/kanban.html#columns">Columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/kanban.html#cards">Cards</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/kanban.html#card-editor">Card editor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/kanban.html#display">Display</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/kanban.html#import-export">Import/Export</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/apps/whiteboard.html">Whiteboard</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/whiteboard.html#toolbar">Toolbar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/whiteboard.html#drawing">Drawing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/whiteboard.html#paint-mode">Paint mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/whiteboard.html#select-mode">Select mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/apps/whiteboard.html#export">Export</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developer Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../setup.html">Instance locale de d√©veloppement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup.html#prerequis">Pr√©requis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup.html#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup.html#cache-et-compilation-important">Cache et compilation (important)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup.html#lancement-en-mode-developpement">Lancement en mode d√©veloppement</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contribute.html">Contribuer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contribute.html#licence">Licence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contribute.html#git">Git</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../contribute.html#pull-requests">Pull requests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../contribute.html#branches">Branches</a></li>
<li class="toctree-l4"><a class="reference internal" href="../contribute.html#avant-de-contribuer">Avant de contribuer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basics.html">Key elements in CryptPad</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basics.html#zero-knowledge">Zero-knowledge</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../basics.html#what-our-server-can-see">What our server can see</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../basics.html#content-security-policy-csp-and-security">Content Security Policy (CSP) and security</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics.html#customization">Customization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics.html#code-rules">Code rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basics.html#translation-keys">Translation keys</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../code.html">Code</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../general.html">G√©n√©ralit√©s</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../general.html#les-urls-safe-et-unsafe">Les URLs ‚Äúsafe‚Äù et ‚Äúunsafe‚Äù</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general.html#structure-en-5-niveaux">Structure en 5 niveaux</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general.html#chiffrement">Chiffrement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../general.html#drive-et-journal-de-pins">Drive et journal de ‚Äúpins‚Äù</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../general.html#exemple">Exemple</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../general.html#inscription-connexion-et-block">Inscription, connexion et block</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../general.html#exemple-2">Exemple</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../general.html#communication-client-serveur-netflux">Communication client-serveur (Netflux)</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../general.html#cote-serveur">C√¥t√© serveur</a></li>
<li class="toctree-l5"><a class="reference internal" href="../general.html#cote-client">C√¥t√© client</a></li>
<li class="toctree-l5"><a class="reference internal" href="../general.html#exemple-3">Exemple</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 current"><a class="reference internal" href="../client.html">Client</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Architecture client</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#worker">Worker</a></li>
<li class="toctree-l5"><a class="reference internal" href="#outer">Outer</a></li>
<li class="toctree-l5"><a class="reference internal" href="#inner">Inner</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="chainpad.html">ChainPad et Listmap</a><ul>
<li class="toctree-l5"><a class="reference internal" href="chainpad.html#chainpad">ChainPad</a></li>
<li class="toctree-l5"><a class="reference internal" href="chainpad.html#checkpoints">Checkpoints</a></li>
<li class="toctree-l5"><a class="reference internal" href="chainpad.html#chainpad-avec-des-objets">ChainPad avec des objets</a></li>
<li class="toctree-l5"><a class="reference internal" href="chainpad.html#chainpad-netflux">Chainpad-netflux</a></li>
<li class="toctree-l5"><a class="reference internal" href="chainpad.html#listmap">Listmap</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="translations.html">Utiliser les cl√©s de traduction</a><ul>
<li class="toctree-l5"><a class="reference internal" href="translations.html#utilisation">Utilisation</a></li>
<li class="toctree-l5"><a class="reference internal" href="translations.html#structure">Structure</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="framework.html">Framework</a><ul>
<li class="toctree-l5"><a class="reference internal" href="framework.html#www-common-sframe-app-outer-js">www/common/sframe-app-outer.js</a></li>
<li class="toctree-l5"><a class="reference internal" href="framework.html#www-common-sframe-app-framework-js">www/common/sframe-app-framework.js</a></li>
<li class="toctree-l5"><a class="reference internal" href="framework.html#customize-dist-src-less2-include-framework-less">customize.dist/src/less2/include/framework.less</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="worker.html">Worker</a><ul>
<li class="toctree-l5"><a class="reference internal" href="worker.html#async-store-js-et-modules">async-store.js et modules</a></li>
<li class="toctree-l5"><a class="reference internal" href="worker.html#commandes-de-lobjet-store">Commandes de l‚Äôobjet ‚ÄúStore‚Äù</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="outer.html">Outer</a><ul>
<li class="toctree-l5"><a class="reference internal" href="outer.html#communication-entre-les-niveaux">Communication entre les niveaux</a></li>
<li class="toctree-l5"><a class="reference internal" href="outer.html#communication-avec-inner-sframe-common-outer">Communication avec inner - sframe-common-outer</a></li>
<li class="toctree-l5"><a class="reference internal" href="outer.html#communication-avec-le-worker-cryptpad-common">Communication avec le worker - cryptpad-common</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="inner.html">Inner</a><ul>
<li class="toctree-l5"><a class="reference internal" href="inner.html#fonctionnement">Fonctionnement</a></li>
<li class="toctree-l5"><a class="reference internal" href="inner.html#metadata-manager">metadata-manager</a></li>
<li class="toctree-l5"><a class="reference internal" href="inner.html#modules-dinterface">Modules d‚Äôinterface</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../admin_guide/index.html">Administrator Guide (in progress)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_contribute.html">How to contribute</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../how_to_contribute.html#spread-the-word">Spread the word</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how_to_contribute.html#report-bugs">Report bugs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how_to_contribute.html#translate-cryptpad">Translate CryptPad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how_to_contribute.html#contribute-to-the-code">Contribute to the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how_to_contribute.html#financial-support">Financial support</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

	<!-- start top banner area (for fundraisers or messages)

	<div style="text-align: center; background-color: #333">
		<a href="https://krita.org/en/fundraising-2018-campaign/" target="_self" onclick="ga('send', 'event', 'frontpage', 'button', 'Fundraiser 2018');">
			<img src="https://krita.org/wp-content/themes/krita-org-theme/images/decoration/2018-fundraiser-banner.png" style="max-width: 100%">
		</a>
	</div>
	
	 end top banner area -->

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CryptPad</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Index</a> &raquo;</li>
        
          <li><a href="../index.html">Developer Guide</a> &raquo;</li>
        
          <li><a href="../code.html">Code</a> &raquo;</li>
        
          <li><a href="../client.html">Client</a> &raquo;</li>
        
      <li>Architecture client</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/dev_guide/client/architecture.rst.txt" rel="nofollow"> 
             
              <img src="../../_static/images/source-code.png" />
             <!-- View page source -->

          </a>
          
        
      </li>
    
  </ul>

  
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="architecture-client">
<h1>Architecture client<a class="headerlink" href="#architecture-client" title="Permalink to this headline">¬∂</a></h1>
<p>L‚Äôarchitecture client est s√©par√©e en 3 niveaux. Le worker est commun √†
tous les onglets CryptPad ouverts dans un m√™me navigateur et chaque
onglet contient son propre ‚Äúouter‚Äù et ses iframes. ‚Äúouter‚Äù correspond au
niveau de base, c‚Äôest-√†-dire au fichier HTML charg√© en premier par le
navigateur. Deux iframes sont ouvertes, la premi√®re contenant toute
l‚Äôinterface de l‚Äôapplication et ouverte sur la domaine ‚Äúsafe‚Äù, la
seconde contenant les √©l√©ments d‚Äôinterface devant afficher des donn√©es
confidentielles et donc ouverte sur le domaine unsafe. Chacun des trois
niveaux a ses propres r√¥les qui vont √™tre d√©taill√©s dans cette partie.</p>
<img alt="../../_images/client.png" class="screenshot" src="../../_images/client.png" />
<div class="section" id="worker">
<span id="architecture-worker"></span><h2>Worker<a class="headerlink" href="#worker" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="fonctionnement">
<h3>Fonctionnement<a class="headerlink" href="#fonctionnement" title="Permalink to this headline">¬∂</a></h3>
<p>Le worker est l‚Äôunique lien WebSocket avec le serveur pour tous les
onglets CryptPad. Cela est effectu√© gr√¢ce √† la technologie SharedWorker,
qui permet d‚Äôouvrir un ‚ÄúWebworker‚Äù commun √† tous les onglets ouverts sur
la m√™me origine. Les avantages sont alors multiples :</p>
<ul class="simple">
<li><p>Gain en ressources sur le client (m√©moire, CPU, et r√©seau √©conomis√©s
en √©vitant les r√©p√©titions de t√¢ches)</p></li>
<li><p>Gain en ressources sur le serveur (une unique connexion avec chaque
client)</p></li>
<li><p>Les ‚Äúworkers‚Äù repr√©sentent du code ex√©cut√© dans un thread diff√©rent
de l‚Äôonglet principal, ce qui permet d‚Äôeffectuer des calculs plus
lourds sans ralentir la page.</p></li>
</ul>
<p>Il faut toutefois noter que tous les navigateurs n‚Äôont pas impl√©ment√©
les SharedWorkers. Ils ne sont disponibles que sur Firefox ainsi que les
navigateurs bas√©s sur Chromium. Internet Explorer ainsi que les
anciennes versions d‚ÄôEdge ne les supportent pas mais les nouvelles
versions d‚ÄôEdge √©tant bas√©es sur Chromium, elles le permettent. Apple ne
souhaite pas les d√©velopper par <a class="reference external" href="https://twitter.com/xeenon/status/652573047623323648">manque d‚Äôadoption de la part des
d√©veloppeurs</a>.</p>
<p>Pour ces navigateurs obsol√®tes, le syst√®me bascule automatique sur des
‚ÄúWebWorkers‚Äù classiques, c‚Äôest-√†-dire 1 worker par onglet. Cela permet
toujours l‚Äôutilisation d‚Äôun thread s√©par√© pour les calculs assez lourds,
mais cela ralentit fortement la chargement des onglets lorsque le compte
utilisateurs contient beaucoup de donn√©es. Enfin, si les WebWorkers ont
√©t√© d√©sactiv√©s dans le navigateur, un dernier syst√®me est en place afin
d‚Äôeffectuer le travail du worker dans l‚Äôonglet principal au niveau
‚Äúouter‚Äù. Cela n‚Äôa aucun impact sur le fonctionnement du code mais ne
permet pas de profiter des avantages des workers.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Il est possible de d√©sactiver facilement l‚Äôutilisation des workers dans CryptPad. Cela peut faciliter le d√©bogage dans certains cas, la console des Shared Workers n‚Äô√©tant pas facilement accessible.  Pour cela, il suffit d‚Äôentrer <code class="docutils literal notranslate"><span class="pre">localStorage.CryptPad_noWorkers</span> <span class="pre">=</span> <span class="pre">&quot;1&quot;</span></code> dans la console JavaScript du navigateur. Pour r√©activer les workers, il faut alors supprimer ou changer la valeur de cette cl√© du localStorage.</p>
</div>
</div>
<div class="section" id="contenu">
<h3>Contenu<a class="headerlink" href="#contenu" title="Permalink to this headline">¬∂</a></h3>
<p>Le niveau de code ‚Äúworker‚Äù est ouvert depuis le niveau ‚Äúouter‚Äù, une fois
que des v√©rifications initiales ont √©t√© effectu√©es. C‚Äôest ‚Äúouter‚Äù qui
d√©cide quel type de worker il peut utiliser (SharedWorker, WebWorker ou
rien). Il initialise alors le worker avec le ‚Äúconnecteur‚Äù correspondant
√† ce type de worker :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">www/common/outer/sharedworker.js</span></code> pour le SharedWorker</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">www/common/outer/webworker.js</span></code> pour le SharedWorker</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">www/common/outer/noworker.js</span></code> pour le SharedWorker</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Il existe aussi un fichier ‚Äúserviceworker.js‚Äù pour lancer le worker dans un service worker, qui a √©galement d‚Äôautres avantages (comme la compatibilit√©s avec davantage de navigateurs) mais pose certaines contraintes incompatibles avec le code actuel. Aucune solution n‚Äôa pour l‚Äôinstant √©t√© trouv√©e.</p>
</div>
<p>Une fois le connecteur charg√© avec la technologie souhait√©e, c‚Äôest
exactement le m√™me code qui r√©git les 3 types de syst√®me.</p>
<ol class="arabic simple">
<li><p>Un <strong>canal de communication asynchrone</strong> est d‚Äôabord initialis√© avec
le niveau ‚Äúouter‚Äù afn de recevoir des commandes et d‚Äôenvoyer des
√©v√®nements.</p></li>
<li><p>Un fichier <code class="docutils literal notranslate"><span class="pre">www/common/outer/store-rpc.js</span></code> traduit les commandes
texte en fonctions √† appeler.</p></li>
<li><p>Un Store principal est cr√©√© dans <code class="docutils literal notranslate"><span class="pre">www/common/outer/async-store.js</span></code>.
c‚Äôest lui qui contient les fonctions correspondant aux commandes et
qui charge tous les modules n√©cessaires au fonctionnement du worker.</p></li>
</ol>
<p>Tout acc√®s √† du contenu se trouvant dans la base de donn√©es du serveur
s‚Äôeffectue alors via des commandes au worker. Ce contenu repr√©sente :</p>
<ul class="simple">
<li><p>Les donn√©es du compte utilisateur (nom, cl√©s personnelles, acc√®s aux
diff√©rents modules)</p>
<ul>
<li><p>Drive, dossiers partag√©s, contacts, cl√©s d‚Äôacc√®s aux √©quipes,
profil, pr√©f√©rences, etc.</p></li>
</ul>
</li>
<li><p>Les donn√©es des √©quipes</p>
<ul>
<li><p>Drive, dossiers partag√©s, membres, metadonn√©es (image et nom de
l‚Äô√©quipe)</p></li>
</ul>
</li>
<li><p>L‚Äôacc√®s aux pads (ou documents collaboratifs) pour chaque onglet
CryptPad ouvert dans le navigateur</p></li>
</ul>
</div>
<div class="section" id="debogage">
<h3>D√©bogage<a class="headerlink" href="#debogage" title="Permalink to this headline">¬∂</a></h3>
<p>Lorsqu‚Äôun utilisateur rencontre un bug dans CryptPad, tout se passe
g√©n√©ralement au niveau du client et aucune donn√©e n‚Äôest transmise au
serveur. La console JavaScript permet alors de d√©tecter toute erreur
ayant pu survenir dans le code, mais cette console ne concerne que
l‚Äôonglet actuel. C‚Äôest-√†-dire qu‚Äôelle se limite aux niveaux ‚Äúouter‚Äù et
‚Äúinner‚Äù et qu‚Äôil n‚Äôest pas possible d‚Äôacc√©der au niveau ‚ÄúSharedWorker‚Äù
directement. Firefox essaye toutefois d‚Äôafficher une copie des messages
de la console du SharedWorker dans la console de la page, mais cela
reste limit√© et ne permet pas l‚Äôex√©cution de code ou le d√©bogage avanc√©.</p>
<p>Il faut alors utiliser la <strong>console du SharedWorker</strong> disponible de la
mani√®re suivante :</p>
<ul class="simple">
<li><p>Dans Chrome et Chromium</p>
<ul>
<li><p>Ouvrir la page <code class="docutils literal notranslate"><span class="pre">chrome://inspect</span></code></p></li>
<li><p>Ouvrir la partie ‚ÄúShared workers‚Äù</p></li>
<li><p>Rep√©rer le worker souhait√© et cliquer sur ‚Äúinpect‚Äù</p></li>
</ul>
</li>
<li><p>Dans Edge (bas√© sur Chromium)</p>
<ul>
<li><p>Ouvrir la page <code class="docutils literal notranslate"><span class="pre">edge://inspect</span></code></p></li>
<li><p>Ouvrir la partie ‚ÄúShared workers‚Äù</p></li>
<li><p>Rep√©rer le worker souhait√© et cliquer sur ‚Äúinpect‚Äù</p></li>
</ul>
</li>
<li><p>Dans Firefox</p>
<ul>
<li><p>Ouvrir la page <code class="docutils literal notranslate"><span class="pre">about:debugging</span></code></p></li>
<li><p>Ouvrir la partie ‚ÄúCe Firefox‚Äù</p></li>
<li><p>Rep√©rer le worker souhait√© dans ‚ÄúWorkers partag√©s‚Äù et cliquer sur
‚ÄúExaminer‚Äù</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="outer">
<h2>Outer<a class="headerlink" href="#outer" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="fonctionnement-1">
<span id="id1"></span><h3>Fonctionnement<a class="headerlink" href="#fonctionnement-1" title="Permalink to this headline">¬∂</a></h3>
<p>Le niveau appel√© ‚Äúouter‚Äù est le niveau de base, correspondant au fichier
HTML charg√© par le navigateur. Il est nomm√© ainsi par le fait que c‚Äôest
le code situ√© √† l‚Äôext√©rieur de l‚Äôiframe.</p>
<p>Chaque application commence donc par son propre fichier ‚Äúindex.html‚Äù. Ce
fichier va charger le code JavaScript de base, g√©n√©ralement situ√© dans
un fichier ‚Äúmain.js‚Äù pour l‚Äôapplication. On cherche ici √† initialiser
les diff√©rents niveaux le plus rapidement possible car le niveau ‚Äúouter‚Äù
n‚Äôaffiche aucune interface et afficher un √©cran blanc n‚Äôest pas
int√©ressant pour l‚Äôutilisateur. c‚Äôest donc l‚Äôiframe ‚Äúinner‚Äù qui est
d‚Äôabord ouverte afin d‚Äôafficher l‚Äô√©cran de chargement.</p>
<p>Le fichier ‚Äúmain.js‚Äù de chaque application va alors commencer √† charger
le code principal, commun √† toutes les applications au niveau ‚Äúouter‚Äù.
La premi√®re partie est situ√©e dans
<code class="docutils literal notranslate"><span class="pre">www/common/sframe-common-outer.js</span></code>. C‚Äôest ce module qui va g√©rer la
communication entre les niveaux ‚Äúouter‚Äù et ‚Äúinner‚Äù. De la m√™me mani√®re
que pour le worker, ces 2 niveuax peuvent s‚Äôenvoyer des commandes ou des
√©v√®nements.</p>
<p>Ce module va √©galement charger <code class="docutils literal notranslate"><span class="pre">www/common/cryptpad-common.js</span></code> qui
repr√©sente cette fois la communication entre les niveaux ‚Äúouter‚Äù et
‚Äúworker‚Äù. ‚Äúcryptpad-common‚Äù va d‚Äôabord choisir le meilleur type de
worker disponible dans le navigateur. Il va l‚Äôinitialiser, cr√©er un
canal de communication puis envoyer la commande principale permettant de
charger le compte utilisateur.</p>
<p>Une fois le compte utilisateur charg√© par le worker,
‚Äúsframe-common-outer‚Äù va pouvoir informer ‚Äúinner‚Äù et c‚Äôest alors
l‚Äôinitialisation du pad (si applicable) ou du contenu de l‚Äôapplication
qui va avoir lieu.</p>
<p>Le niveau ‚Äúouter‚Äù fonctionne donc comme un interm√©diaire entre
l‚Äôinterface et la ‚Äúbase de donn√©es locale‚Äù. Il maintient le tout ouvert,
permet les communications et effectuent certaines t√¢ches.</p>
</div>
<div class="section" id="contenu-1">
<span id="id2"></span><h3>Contenu<a class="headerlink" href="#contenu-1" title="Permalink to this headline">¬∂</a></h3>
<p>Les t√¢ches effectu√©es par ‚Äúouter‚Äù ne se limitent pas √† l‚Äôinitialisation
du contenu et la transmission de messages. Le code actuel est bas√© sur
le principe que plusieurs onglets CryptPad seront ouverts dans le
navigateur (h√©ritage du fonctionnement tr√®s simple des d√©buts de
CryptPad et potentiellement difficile √† changer). Le SharedWorker permet
d‚Äôeffectuer des t√¢ches r√©guli√®res dans un thread commun √† tous ces
onglets, mais il ne faut pas que l‚Äôon surcharge ce thread au risque de
ralentir l‚Äôensemble des onglets. C‚Äôest pourquoi, lorsqu‚Äôun onglet
souhaite acc√©der √† un document collaboratif, la r√©cup√©ration du contenu
chiffr√© est effectu√© par le ‚Äúworker‚Äù, mais le <strong>d√©chiffrement</strong> de
celui-ci est effectu√© dans ‚Äúouter‚Äù.</p>
<p>C‚Äôest √©galement ‚Äúouter‚Äù qui se charge de la gestion des cl√©s du document
ouvert, des op√©rations de changement de mot de passe du compte ou d‚Äôun
document, de la copie de pad et du syst√®me de connexion au compte (login
avec Scrypt).</p>
<p>Enifn, le localStorage (qui contient des donn√©es persistantes) est li√©
au domaine principal et est donc g√©r√© exclusivement par ‚Äúouter‚Äù.</p>
</div>
</div>
<div class="section" id="inner">
<h2>Inner<a class="headerlink" href="#inner" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="fonctionnement-2">
<span id="id3"></span><h3>Fonctionnement<a class="headerlink" href="#fonctionnement-2" title="Permalink to this headline">¬∂</a></h3>
<p>Lorsqu‚Äôun nouvel onglet est ouvert, ‚Äúouter‚Äù va charger d√©s que possible
l‚Äôiframe ‚Äúinner‚Äù principale. Chaque application poss√®de pour cela sa
propre page ‚Äúinner.html‚Äù qui repr√©sente le point de d√©part de l‚Äôiframe.
Ce fichier va alors charger le code de base de l‚Äôapplication ‚Äúinner.js‚Äù,
qui va √™tre charg√© d‚Äôouvrir tous les modules n√©cessaires. La plupart des
modules √©tant communs √† toutes les applications, le fichier ‚Äúinner.js‚Äù
est souvent le seul fichier propre √† une application donn√©e.</p>
<p>Les √©l√©ments importants charg√©s par ‚Äúinner.js‚Äù concernent le code
permettant de communiquer avec ‚Äúouter‚Äù, les √©l√©ments d‚Äôinterface communs
(barre d‚Äôoutils, menus r√©utilisables, etc.) mais aussi tout le style de
l‚Äôapplication et des √©l√©ments communs. Le style est charg√© par un
fichier ‚Äú.less‚Äù propre √† l‚Äôapplication depuis ‚Äúinner.js‚Äù, qui importe
tout le style n√©cessaire √† cette application. Un syst√®me less propre √†
CryptPad qui compile en CSS dans le navigateur du client est utilis√©.
Cela permet d‚Äôutiliser toutes les fonctions avanc√©es de LESS dans le
code, avec notamment les mixins, sans se soucier d‚Äôajouter une √©tape de
build qui n‚Äôest pas n√©cessaire pour le JavaScript non plus.</p>
<p>Le but de l‚Äôiframe ‚Äúinner‚Äù principale est de fonctionner avec un domaine
(ou une origine HTTP) diff√©rent, ce qui permet de profiter de
protections ‚Äúcross-domain‚Äù suppl√©mentaire. Cette iframe est l‚Äôunique
partie du syst√®me qui affiche une interface o√π les utilisateurs
int√©ragissent entre eux, ce qui la rend particuli√®rement vuln√©rable en
cas de faille dans le code. L‚Äôisoler, d‚Äôune part dans une iframe, et
d‚Äôautre part avec un domaine diff√©rent, permet de prot√©ger toutes les
donn√©es qui ne sont pas directement affich√©es dans le document. Il est
m√™me ainsi <strong>impossible de r√©cup√©rer les cl√©s du pad courant</strong> depuis
l‚Äôiframe ‚Äúinner‚Äù. Seul le contenu d√©chiffr√© est accessible, ainsi que
les donn√©es publiques de l‚Äôutilisateur et les utilisateurs actuels du
pad.</p>
<p>Afin de pouvoir afficher √† l‚Äô√©cran des donn√©es sensibles telles que le
lien du pad, son mot de passe ou m√™me ses propri√©taires dans les
fen√™tres de partage ou de gestion des acc√®s, ces √©l√©ments sont ouverts
dans une iframe s√©par√©e, appel√©e ‚Äúsecure-iframe‚Äù. Cette iframe s√©curis√©e
est ouverte sur le domaine ‚Äúsafe‚Äù bien qu‚Äôelle aie acc√®s √† des donn√©es
sensibles pour des raisons de simplicit√© du code, mais elle n‚Äôa aucun
contact direct avec l‚Äôiframe principale. Tous les √©changes possibles
entre l‚Äôiframe principale (qui affiche l‚Äôapplication ouverte) et
l‚Äôiframe s√©curis√©e (qui affiche des donn√©es sensibles) se font par
l‚Äôinterm√©diaire de ‚Äúouter‚Äù. Ces deux iframes sont toutes les deux filles
de ‚Äúouter‚Äù et elles ne peuvent donc pas acc√©der aux donn√©es l‚Äôune de
l‚Äôautre, ce qui rend possible l‚Äôutilisation du domaine ‚Äúsafe‚Äù sur
l‚Äôiframe s√©curis√©e acc√©dant au contenu ‚Äúunsafe‚Äù.</p>
</div>
<div class="section" id="contenu-2">
<span id="id4"></span><h3>Contenu<a class="headerlink" href="#contenu-2" title="Permalink to this headline">¬∂</a></h3>
<p>Les iframes ‚Äúinner‚Äù se chargent d‚Äôafficher l‚Äôint√©gralit√© de l‚Äôinterface
utilisateur. Cela concerne aussi bien les √©l√©ments communs √† toutes les
applications (barre d‚Äôoutils, menu utilisateur, actions principales) que
les √©l√©ments communs aux documents collaboratifs (fen√™tres d‚Äôacc√®s ou de
partage, liste d‚Äôutilisateurs) ainsi que les √©l√©ments propres √† chaque
application (rendu du contenu). Les fen√™tres ‚Äúpartage‚Äù, ‚Äúacc√®s‚Äù,
‚Äúpropri√©t√©s‚Äù ainsi que la fen√™tre d‚Äôupload ou de s√©lection d‚Äôun fichier
sont affich√©es par l‚Äôiframe s√©curis√©e. Tous le reste se trouve dans
l‚Äôiframe principale.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="chainpad.html" class="btn btn-neutral float-right" title="ChainPad et Listmap" accesskey="n" rel="next"> <!-- Next --> <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../client.html" class="btn btn-neutral" title="Client" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> <!-- Previous  -->  </a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, CryptPad Team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a modified <a href="https://github.com/rtfd/sphinx_rtd_theme">RTD theme</a>.<br/>
  <a href="https://cryptpad.fr" title="CryptPad flagship instance">CryptPad flagship instance</a> |
  <a href="#" title="The Gitlab instance to edit this pages and collaborate.">Git repository for docs.cryptpad.fr </a>
  . 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'3.23.0',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>